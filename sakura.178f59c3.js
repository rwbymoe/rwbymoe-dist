parcelRequire=function(J,L,K,B){function m(h,q){function y(D){return m(y.resolve(D))}function C(D){return J[h][1][D]||D}if(!L[h]){if(!J[h]){var E="function"===typeof parcelRequire&&parcelRequire;if(!q&&E)return E(h,!0);if(A)return A(h,!0);if(k&&"string"===typeof h)return k(h);q=Error("Cannot find module '"+h+"'");q.code="MODULE_NOT_FOUND";throw q;}y.resolve=C;y.cache={};q=L[h]=new m.Module(h);J[h][0].call(q.exports,y,q,q.exports,this)}return L[h].exports}var A="function"===typeof parcelRequire&&parcelRequire,
k="function"===typeof require&&require;m.isParcelRequire=!0;m.Module=function(h){this.id=h;this.bundle=m;this.exports={}};m.modules=J;m.cache=L;m.parent=A;m.register=function(h,q){J[h]=[function(y,C){C.exports=q},{}]};for(var w,p=0;p<K.length;p++)try{m(K[p])}catch(h){w||(w=h)}if(K.length){var x=m(K[K.length-1]);"object"===typeof exports&&"undefined"!==typeof module?module.exports=x:"function"===typeof define&&define.amd?define(function(){return x}):B&&(this[B]=x)}parcelRequire=m;if(w)throw w;return m}({sxca:[function(J,
L,K){var B,m,A,k,w,p,x,h,q,y,C,E;function D(a,c){a=b.createShader(a);b.shaderSource(a,c);b.compileShader(a);return b.getShaderParameter(a,b.COMPILE_STATUS)?a:(c=b.getShaderInfoLog(a),b.deleteShader(a),console.error(c),null)}function S(a,c,e,f){a=D(b.VERTEX_SHADER,a);var d=D(b.FRAGMENT_SHADER,c);if(null==a||null==d)return null;c=b.createProgram();b.attachShader(c,a);b.attachShader(c,d);b.deleteShader(a);b.deleteShader(d);b.linkProgram(c);if(!b.getProgramParameter(c,b.LINK_STATUS))return f=b.getProgramInfoLog(c),
console.error(f),null;if(e)for(c.uniforms={},a=0;a<e.length;a++)c.uniforms[e[a]]=b.getUniformLocation(c,e[a]);if(f)for(c.attributes={},a=0;a<f.length;a++)e=f[a],c.attributes[e]=b.getAttribLocation(c,e);return c}function N(a){b.useProgram(a);for(var c in a.attributes)b.enableVertexAttribArray(a.attributes[c])}function F(a){for(var c in a.attributes)b.disableVertexAttribArray(a.attributes[c]);b.useProgram(null)}function Y(){l=n.create(20,20,20);l.x=l.y*g.aspect;w.x=10;w.y=l.z;w.z=.1;for(var a=2*Math.PI,
c=n.create(0,0,0),e=0,f=function(){return 2*Math.random()-1},d=0;d<p;d++){var r=x[d];c.x=.3*f()+.8;c.y=.2*f()-1;c.z=.3*f()+.5;n.normalize(c);e=2+1*Math.random();r.setVelocity(c.x*e,c.y*e,c.z*e);r.setRotation(f()*a*.5,f()*a*.5,f()*a*.5);r.setPosition(f()*l.x,f()*l.y,f()*l.z);r.setEulerAngles(Math.random()*Math.PI*2,Math.random()*Math.PI*2,Math.random()*Math.PI*2);r.setSize(.9+.1*Math.random())}}function Z(){for(var a=2*Math.PI,c=function(t,u,Q){Math.abs(t.position[u])-.5*t.size>Q&&(t.position[u]=0<
t.position[u]?t.position[u]-2*Q:t.position[u]+2*Q)},e=function(t,u){t.euler[u]%=a;0>t.euler[u]&&(t.euler[u]+=a)},f=0;f<p;f++){var d=x[f];d.update(z.delta,z.elapsed);c(d,0,l.x);c(d,1,l.y);c(d,2,l.z);e(d,0);e(d,1);e(d,2);d.alpha=1;d.zkey=v.matrix[2]*d.position[0]+v.matrix[6]*d.position[1]+v.matrix[10]*d.position[2]+v.matrix[14]}x.sort(function(t,u){return t.zkey-u.zkey});c=q;e=y;var r=C;for(f=0;f<p;f++)d=x[f],h[c]=d.position[0],h[c+1]=d.position[1],h[c+2]=d.position[2],c+=3,h[e]=d.euler[0],h[e+1]=d.euler[1],
h[e+2]=d.euler[2],e+=3,h[r]=d.size,h[r+1]=d.alpha,r+=2;b.enable(b.BLEND);b.blendFunc(b.SRC_ALPHA,b.ONE_MINUS_SRC_ALPHA);d=A;N(d);b.uniformMatrix4fv(d.uniforms.uProjection,!1,G.matrix);b.uniformMatrix4fv(d.uniforms.uModelview,!1,v.matrix);b.uniform3fv(d.uniforms.uResolution,g.array);b.uniform3fv(d.uniforms.uDOF,n.arrayForm(v.dof));b.uniform3fv(d.uniforms.uFade,n.arrayForm(w));b.bindBuffer(b.ARRAY_BUFFER,E);b.bufferData(b.ARRAY_BUFFER,h,b.DYNAMIC_DRAW);b.vertexAttribPointer(d.attributes.aPosition,3,
b.FLOAT,!1,0,q*Float32Array.BYTES_PER_ELEMENT);b.vertexAttribPointer(d.attributes.aEuler,3,b.FLOAT,!1,0,y*Float32Array.BYTES_PER_ELEMENT);b.vertexAttribPointer(d.attributes.aMisc,2,b.FLOAT,!1,0,C*Float32Array.BYTES_PER_ELEMENT);for(f=1;2>f;f++)c=-2*f,k[0]=-1*l.x,k[1]=-1*l.y,k[2]=l.z*c,b.uniform3fv(d.uniforms.uOffset,k),b.drawArrays(b.POINT,0,p),k[0]=-1*l.x,k[1]=1*l.y,k[2]=l.z*c,b.uniform3fv(d.uniforms.uOffset,k),b.drawArrays(b.POINT,0,p),k[0]=1*l.x,k[1]=-1*l.y,k[2]=l.z*c,b.uniform3fv(d.uniforms.uOffset,
k),b.drawArrays(b.POINT,0,p),k[0]=1*l.x,k[1]=1*l.y,k[2]=l.z*c,b.uniform3fv(d.uniforms.uOffset,k),b.drawArrays(b.POINT,0,p);k[0]=0;k[1]=0;k[2]=0;b.uniform3fv(d.uniforms.uOffset,k);b.drawArrays(b.POINT,0,p);b.bindBuffer(b.ARRAY_BUFFER,null);F(d);b.enable(b.DEPTH_TEST);b.disable(b.BLEND)}function R(a,c,e,f){var d={},r=["uResolution","uSrc","uDelta"];e&&(r=r.concat(e));e=["aPosition"];f&&(e=e.concat(f));d.program=S(a,c,r,e);N(d.program);d.dataArray=new Float32Array([-1,-1,1,-1,-1,1,1,1]);d.buffer=b.createBuffer();
b.bindBuffer(b.ARRAY_BUFFER,d.buffer);b.bufferData(b.ARRAY_BUFFER,d.dataArray,b.STATIC_DRAW);b.bindBuffer(b.ARRAY_BUFFER,null);F(d.program);return d}function O(a,c){a=a.program;N(a);b.uniform3fv(a.uniforms.uResolution,g.array);null!=c&&(b.uniform2fv(a.uniforms.uDelta,c.dtxArray),b.uniform1i(a.uniforms.uSrc,0),b.activeTexture(b.TEXTURE0),b.bindTexture(b.TEXTURE_2D,c.texture))}function P(a){b.bindBuffer(b.ARRAY_BUFFER,a.buffer);b.vertexAttribPointer(a.program.attributes.aPosition,2,b.FLOAT,!1,0,0);
b.drawArrays(b.TRIANGLE_STRIP,0,4)}function aa(){b.enable(b.TEXTURE_2D);b.disable(b.DEPTH_TEST);var a=function(d,r){b.bindFramebuffer(b.FRAMEBUFFER,d.frameBuffer);b.viewport(0,0,d.width,d.height);r&&(b.clearColor(0,0,0,0),b.clear(b.COLOR_BUFFER_BIT|b.DEPTH_BUFFER_BIT))};a(g.wHalfRT0,!0);O(B,g.mainRT);P(B);F(B.program);for(var c=0;2>c;c++){var e=1.5+1*c,f=2+1*c;a(g.wHalfRT1,!0);O(m,g.wHalfRT0);b.uniform4f(m.program.uniforms.uBlurDir,e,0,f,0);P(m);F(m.program);a(g.wHalfRT0,!0);O(m,g.wHalfRT1);b.uniform4f(m.program.uniforms.uBlurDir,
0,e,0,f);P(m);F(m.program)}b.bindFramebuffer(b.FRAMEBUFFER,null);b.viewport(0,0,g.width,g.height);b.clear(b.COLOR_BUFFER_BIT|b.DEPTH_BUFFER_BIT);O(M,g.mainRT);b.uniform1i(M.program.uniforms.uBloom,1);b.activeTexture(b.TEXTURE1);b.bindTexture(b.TEXTURE_2D,g.wHalfRT0.texture);P(M);F(M.program);b.enable(b.DEPTH_TEST)}function T(){Y();v.position.z=l.z+G.nearfar[0];G.angle=180*Math.atan2(l.y,v.position.z+l.z)/Math.PI*2;H.loadProjection(G.matrix,g.aspect,G.angle,G.nearfar[0],G.nearfar[1])}function ba(a){U(document.getElementById("sakura"));
V();W&&T()}function V(){g.setSize(b.canvas.width,b.canvas.height);b.clearColor(.2,.2,.5,1);b.viewport(0,0,g.width,g.height);var a=function(c,e,f){var d=g[c];d&&(b.deleteFramebuffer(d.frameBuffer),b.deleteRenderbuffer(d.renderBuffer),b.deleteTexture(d.texture));d={width:e,height:f,sizeArray:new Float32Array([e,f,e/f]),dtxArray:new Float32Array([1/e,1/f])};d.frameBuffer=b.createFramebuffer();d.renderBuffer=b.createRenderbuffer();d.texture=b.createTexture();b.bindTexture(b.TEXTURE_2D,d.texture);b.texImage2D(b.TEXTURE_2D,
0,b.RGBA,e,f,0,b.RGBA,b.UNSIGNED_BYTE,null);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.LINEAR);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.LINEAR);b.bindFramebuffer(b.FRAMEBUFFER,d.frameBuffer);b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,d.texture,0);b.bindRenderbuffer(b.RENDERBUFFER,d.renderBuffer);b.renderbufferStorage(b.RENDERBUFFER,
b.DEPTH_COMPONENT16,e,f);b.framebufferRenderbuffer(b.FRAMEBUFFER,b.DEPTH_ATTACHMENT,b.RENDERBUFFER,d.renderBuffer);b.bindTexture(b.TEXTURE_2D,null);b.bindRenderbuffer(b.RENDERBUFFER,null);b.bindFramebuffer(b.FRAMEBUFFER,null);g[c]=d};a("mainRT",g.width,g.height);a("wFullRT0",g.width,g.height);a("wFullRT1",g.width,g.height);a("wHalfRT0",g.halfWidth,g.halfHeight);a("wHalfRT1",g.halfWidth,g.halfHeight)}function X(){var a=new Date;z.elapsed=(a-z.start)/1E3;z.delta=(a-z.prev)/1E3;z.prev=a;ca&&requestAnimationFrame(X);
H.loadLookAt(v.matrix,v.position,v.lookat,v.up);b.enable(b.DEPTH_TEST);b.bindFramebuffer(b.FRAMEBUFFER,g.mainRT.frameBuffer);b.viewport(0,0,g.mainRT.width,g.mainRT.height);b.clearColor(.01,.01,.01,0);b.clear(b.COLOR_BUFFER_BIT|b.DEPTH_BUFFER_BIT);Z();aa()}function U(a){var c=document.body,e=document.documentElement;fullw=Math.max(c.clientWidth,c.scrollWidth,e.scrollWidth,e.clientWidth);fullh=Math.max(c.clientHeight,c.scrollHeight,e.scrollHeight,e.clientHeight);a.width=fullw;a.height=fullh}var n={},
H={};n.create=function(a,c,e){return{x:a,y:c,z:e}};n.dot=function(a,c){return a.x*c.x+a.y*c.y+a.z*c.z};n.cross=function(a,c,e){a.x=c.y*e.z-c.z*e.y;a.y=c.z*e.x-c.x*e.z;a.z=c.x*e.y-c.y*e.x};n.normalize=function(a){var c=a.x*a.x+a.y*a.y+a.z*a.z;1E-5<c&&(c=1/Math.sqrt(c),a.x*=c,a.y*=c,a.z*=c)};n.arrayForm=function(a){a.array?(a.array[0]=a.x,a.array[1]=a.y,a.array[2]=a.z):a.array=new Float32Array([a.x,a.y,a.z]);return a.array};H.createIdentity=function(){return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,
0,0,0,0,1])};H.loadProjection=function(a,c,e,f,d){e=f*Math.tan(e*Math.PI/180*.5)*2;a[0]=2*f/(e*c);a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=2*f/e;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=-(d+f)/(d-f);a[11]=-1;a[12]=0;a[13]=0;a[14]=-2*d*f/(d-f);a[15]=0};H.loadLookAt=function(a,c,e,f){e=n.create(c.x-e.x,c.y-e.y,c.z-e.z);n.normalize(e);var d=n.create(1,0,0);n.cross(d,f,e);n.normalize(d);f=n.create(1,0,0);n.cross(f,e,d);n.normalize(f);a[0]=d.x;a[1]=f.x;a[2]=e.x;a[3]=0;a[4]=d.y;a[5]=f.y;a[6]=e.y;a[7]=0;a[8]=d.z;a[9]=
f.z;a[10]=e.z;a[11]=0;a[12]=-(c.x*a[0]+c.y*a[4]+c.z*a[8]);a[13]=-(c.x*a[1]+c.y*a[5]+c.z*a[9]);a[14]=-(c.x*a[2]+c.y*a[6]+c.z*a[10]);a[15]=1};var z={start:0,prev:0,delta:0,elapsed:0},b,g={width:0,height:0,aspect:1,array:new Float32Array(3),halfWidth:0,halfHeight:0,halfArray:new Float32Array(3),setSize:function(a,c){g.width=a;g.height=c;g.aspect=g.width/g.height;g.array[0]=g.width;g.array[1]=g.height;g.array[2]=g.aspect;g.halfWidth=Math.floor(a/2);g.halfHeight=Math.floor(c/2);g.halfArray[0]=g.halfWidth;
g.halfArray[1]=g.halfHeight;g.halfArray[2]=g.halfWidth/g.halfHeight}},G={angle:60,nearfar:new Float32Array([.1,100]),matrix:H.createIdentity()},v={position:n.create(0,0,100),lookat:n.create(0,0,0),up:n.create(0,1,0),dof:n.create(10,4,8),matrix:H.createIdentity()};var l=E=C=y=q=h=x=p=w=k=A=void 0;var W=!1,I=function(){this.velocity=Array(3);this.rotation=Array(3);this.position=Array(3);this.euler=Array(3);this.alpha=this.size=1;this.zkey=0};I.prototype.setVelocity=function(a,c,e){this.velocity[0]=
a;this.velocity[1]=c;this.velocity[2]=e};I.prototype.setRotation=function(a,c,e){this.rotation[0]=a;this.rotation[1]=c;this.rotation[2]=e};I.prototype.setPosition=function(a,c,e){this.position[0]=a;this.position[1]=c;this.position[2]=e};I.prototype.setEulerAngles=function(a,c,e){this.euler[0]=a;this.euler[1]=c;this.euler[2]=e};I.prototype.setSize=function(a){this.size=a};I.prototype.update=function(a,c){this.position[0]+=this.velocity[0]*a;this.position[1]+=this.velocity[1]*a;this.position[2]+=this.velocity[2]*
a;this.euler[0]+=this.rotation[0]*a;this.euler[1]+=this.rotation[1]*a;this.euler[2]+=this.rotation[2]*a};var M=m=B=void 0;var ca=!0;window.addEventListener("load",function(a){a=document.getElementById("sakura");try{U(a),b=a.getContext("experimental-webgl")}catch(e){alert("WebGL not supported."+e);console.error(e);return}window.addEventListener("resize",ba);V();var c=document.getElementById("fx_common_vsh").textContent;a=document.getElementById("fx_brightbuf_fsh").textContent;B=R(c,a,null,null);a=
document.getElementById("fx_dirblur_r4_fsh").textContent;m=R(c,a,["uBlurDir"],null);c=document.getElementById("pp_final_vsh").textContent;a=document.getElementById("pp_final_fsh").textContent;M=R(c,a,["uBloom"],null);a=b.getParameter(b.ALIASED_POINT_SIZE_RANGE);g.pointSize={min:a[0],max:a[1]};a=document.getElementById("sakura_point_vsh").textContent;c=document.getElementById("sakura_point_fsh").textContent;A=S(a,c,"uProjection uModelview uResolution uOffset uDOF uFade".split(" "),["aPosition","aEuler",
"aMisc"]);N(A);k=new Float32Array([0,0,0]);w=n.create(0,10,0);p=160;x=Array(p);h=new Float32Array(8*p);q=0;y=3*p;C=6*p;E=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,E);b.bufferData(b.ARRAY_BUFFER,h,b.DYNAMIC_DRAW);b.bindBuffer(b.ARRAY_BUFFER,null);F(A);for(a=0;a<p;a++)x[a]=new I;W=!0;T();z.start=new Date;z.prev=z.start;X()});(function(a,c){a["r"+c]=a["r"+c]||a["webkitR"+c]||a["mozR"+c]||a["msR"+c]||a["oR"+c]||function(e){a.setTimeout(e,1E3/60)}})(window,"equestAnimationFrame")},{}]},{},["sxca"],
null);